<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Forum - UCIQUE</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white min-h-screen">
<div class="max-w-3xl mx-auto py-8 px-4">
<h1 class="text-3xl mb-4">Forum</h1>
<div id="forum"></div>
</div>
<script>
document.addEventListener("DOMContentLoaded", async () => {
  const params = new URLSearchParams(window.location.search);
  const discussionId = params.get("discussion");
  const forum = document.getElementById("forum");
  if (discussionId) {
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.setAttribute("data-repo", "Ucique/chatty5.online");
    script.setAttribute("data-repo-id", "R_kgDOPfkH8A");
    script.setAttribute("data-category", "General");
    script.setAttribute("data-category-id", "DIC_kwDOPfkH8M4CuWyT");
    script.setAttribute("data-mapping", "specific");
    script.setAttribute("data-strict", "1");
    script.setAttribute("data-reactions-enabled", "1");
    script.setAttribute("data-emit-metadata", "0");
    script.setAttribute("data-input-position", "bottom");
    script.setAttribute("data-theme", "dark");
    script.setAttribute("data-discussion-id", discussionId);
    script.setAttribute("crossorigin", "anonymous");
    script.setAttribute("async", "");
    forum.appendChild(script);
  } else {
    const resp = await fetch("https://api.github.com/repos/Ucique/chatty5.online/discussions");
    const discussions = await resp.json();
    const list = document.createElement("ul");
    list.className = "space-y-4";
    discussions.forEach(d => {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = "forum.html?discussion=" + d.node_id;
      a.textContent = d.title + " (" + d.comments + " comments)";
      a.className = "text-blue-400 underline";
      li.appendChild(a);
      list.appendChild(li);
    });
    forum.appendChild(list);
  }
});
</script>
</body>
</html>
